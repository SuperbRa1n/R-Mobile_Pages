import{o as e,c as s,w as t,t as a,v as i,F as l,b as r,n as c,x as n,y as o,A as h,E as u,s as g,j as I,C as d,D as A,k as p,q as B,a as k,z as m,h as S,G as E,I as C,H as w}from"./index-CQZovXBN.js";import{_ as f}from"./custom-waterfalls-flow.D9mpW88x.js";import{r as Q}from"./uni-app.es.Bvjx594B.js";import{_ as y,f as J,h as x,e as L}from"./api.BbjEcOtK.js";const K=y({props:{text:{type:String},keyword:{type:String},color:{type:String,default:"red"}},methods:{getHilightStrArray:(e,s)=>e.replace(new RegExp(`${s}`,"g"),`%%${s}%%`).split("%%")}},[["render",function(u,g,I,d,A,p){const B=h,k=r;return e(),s(k,null,{default:t((()=>[(e(!0),a(l,null,i(p.getHilightStrArray(I.text,I.keyword),((a,i)=>(e(),s(B,{key:i,style:c(a==I.keyword?"color:"+I.color:"")},{default:t((()=>[n(o(a),1)])),_:2},1032,["style"])))),128))])),_:1})}]]);const M=y({components:{customWaterfallsFlow:f,umTexthighlight:K},data:()=>({searchQuery:"",searchOptions:["AI搜图","歌词"],selectedSearchOptionIndex:0,results:[],searchText:"",picList:[]}),methods:{onSearchOptionChange(e){this.selectedSearchOptionIndex=e.detail.value,this.results=[],this.picList=[]},async performSearch(){const e=this.searchQuery.trim();if(!e)return void u({title:"请输入搜索内容",icon:"none"});this.results=[],this.picList=[];const s=this.searchOptions[this.selectedSearchOptionIndex];if("AI搜图"===s)await this.searchImages(e),this.searchText=e;else if("歌词"===s){const s=await this.searchLyrics(e);this.results=s,this.searchText=e}},async searchImages(e){try{g({title:"搜索中..."});const s=await J(e);s&&(this.picList=s.data||[],this.results=[],this.picList.forEach((e=>{this.results.push({image:e.url,index:this.picList.indexOf(e)})}))),I()}catch(s){console.error(s),u({title:"图片搜索失败",icon:"none"})}},async searchLyrics(e){try{g({title:"搜索中..."});const s=await x(e);let t=[];return s&&(t=s.data),I(),t}catch(s){return u({title:"歌词搜索失败",icon:"none"}),[]}},lyricCount(e){let s=0;return e.forEach((e=>{s+=e.lyrics.length})),s},async previewImage(e){const s=await L(this.picList[e].path);d({urls:[s],current:s,longPressActions:{itemList:["保存图片"],success:e=>{0===e.tapIndex&&A({filePath:s,success:()=>{u({title:"保存成功"})},fail:()=>{u({title:"保存失败",icon:"none"})}})}}})},handlePicClick(e,s){this.previewImage(e.index)},refreshWaterfall(){this.$refs.picWaterfall&&this.$refs.picWaterfall.refresh()},goToMusicDetail(e){p({url:`/pages/musicDetail/musicDetail?id=${e}`})}},onShareAppMessage:e=>("button"===e.from&&console.log(e.target),{title:"亲爱的瑞秋",path:"/pages/search/search"}),onShareTimeline:()=>({title:"亲爱的瑞秋"})},[["render",function(c,u,g,I,d,A){const p=h,y=r,J=E,x=C,L=w,M=Q(B("custom-waterfalls-flow"),f),O=Q(B("um-texthighlight"),K);return e(),s(y,{class:"container"},{default:t((()=>[k(y,{class:"searchContainer"},{default:t((()=>[k(y,{class:"searchBox"},{default:t((()=>[k(J,{mode:"selector",range:d.searchOptions,value:d.selectedSearchOptionIndex,onChange:A.onSearchOptionChange},{default:t((()=>[k(y,{class:"picker"},{default:t((()=>[k(p,{style:{"margin-left":"2rpx"}},{default:t((()=>[n(o(d.searchOptions[d.selectedSearchOptionIndex]),1)])),_:1}),m("img",{src:"data:image/png;base64,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",style:{width:"20rpx",height:"20rpx","margin-left":"5rpx","margin-right":"5rpx"}})])),_:1})])),_:1},8,["range","value","onChange"]),k(x,{class:"searchInput",type:"text",placeholder:"请输入搜索内容",modelValue:d.searchQuery,"onUpdate:modelValue":u[0]||(u[0]=e=>d.searchQuery=e)},null,8,["modelValue"]),k(L,{class:"searchButton",onClick:A.performSearch},{default:t((()=>[n("搜索")])),_:1},8,["onClick"])])),_:1})])),_:1}),d.results.length?(e(),s(y,{key:0,class:"resultContainer"},{default:t((()=>["AI搜图"===d.searchOptions[d.selectedSearchOptionIndex]?(e(),s(y,{key:0},{default:t((()=>[k(y,{class:"pic-waterfall-container"},{default:t((()=>[k(M,{ref:"picWaterfall",value:d.results,column:2,addTime:"200",onWapperClick:A.handlePicClick,onImageClick:A.handlePicClick,columnSpace:"0.5"},null,8,["value","onWapperClick","onImageClick"])])),_:1})])),_:1})):"歌词"===d.searchOptions[d.selectedSearchOptionIndex]?(e(),s(y,{key:1},{default:t((()=>[k(y,{class:"searchSummary"},{default:t((()=>[k(p,null,{default:t((()=>[n("共有 "+o(d.results.length)+' 首含有 "'+o(d.searchText)+'" 的歌曲，共 '+o(A.lyricCount(d.results))+" 句歌词。",1)])),_:1})])),_:1}),k(y,{class:"lyricContainer"},{default:t((()=>[(e(!0),a(l,null,i(d.results,((r,c)=>(e(),s(y,{class:"resultItem",key:c,onClick:e=>A.goToMusicDetail(r.music_id)},{default:t((()=>[k(y,{class:"resultItemTitle"},{default:t((()=>[k(p,{class:"resultTitle"},{default:t((()=>[n(o(r.name),1)])),_:2},1024)])),_:2},1024),(e(!0),a(l,null,i(r.lyrics,((a,i)=>(e(),s(y,{key:i,class:"resultItemData"},{default:t((()=>[k(p,{class:"timeMark"},{default:t((()=>[n(o(a.time_mark),1)])),_:2},1024),k(O,{class:"lyricText",text:a.text,keyword:d.searchText,color:"#76a5c3"},null,8,["text","keyword"])])),_:2},1024)))),128))])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):S("",!0)])),_:1})):S("",!0)])),_:1})}],["__scopeId","data-v-eef3644e"]]);export{M as default};
