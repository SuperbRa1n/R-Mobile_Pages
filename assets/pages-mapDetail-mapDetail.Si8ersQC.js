import{o as e,c as a,w as t,a as l,n as i,i as s,b as c,s as o,E as n,j as d,k as r,T as p,q as u,x as m,y as g,h as f,t as h,v as _,F as D,A as y,Q as k,H as v}from"./index-CQZovXBN.js";import{g as w,I as M}from"./runtime.CoBkiQaE.js";import{_ as x,y as I}from"./api.BbjEcOtK.js";import{r as C}from"./uni-app.es.Bvjx594B.js";const b=x(w("i-navigation",M("i-navigation",(e=>'<?xml version="1.0" encoding="UTF-8"?><svg width="'+e.sizeWithUnit+'" height="'+e.sizeWithUnit+'" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M24.5 4L9 44L24.5 34.9091L40 44L24.5 4Z" fill="'+e.colors[1]+'" stroke="'+e.colors[0]+'" stroke-width="'+e.strokeWidth+'" stroke-linejoin="'+e.strokeLinejoin+'"/></svg>'))),[["render",function(o,n,d,r,p,u){const m=s,g=c;return e(),a(g,{class:"a-icon-svg",style:i([o.boxStyle])},{default:t((()=>[l(m,{class:"a-icon-pack-image",src:o.url,mode:"aspectFit"},null,8,["src"])])),_:1},8,["style"])}],["__scopeId","data-v-f649ba60"]]);const F=x({data:()=>({id:"",placeDetail:{},miniMapMarkers:[]}),methods:{async loadPlaceDetail(e){try{o({title:"加载中...",mask:!0});const a=await I(e);0===a.status&&a.data?(this.placeDetail=a.data,this.placeDetail.geo&&(this.miniMapMarkers=[{id:0,latitude:this.placeDetail.geo[1],longitude:this.placeDetail.geo[0],title:this.placeDetail.name,iconPath:"/static/icons/localred.png",width:20,height:30,callout:{content:this.placeDetail.name,color:"#fff",fontSize:12,borderRadius:6,bgColor:"#95C9EF",padding:4,display:"ALWAYS"}}])):n({title:"获取详情失败",icon:"none"})}catch(a){console.error("获取地点详情失败:",a),n({title:"网络错误",icon:"none"})}finally{d()}},handleSourceDetail(e){"video"===e.type?r({url:`/pages/videoDetail/videoDetail?id=${e.inner_id}`}):"pic"!==e.type&&"image"!==e.type||r({url:`/pages/picDetail/picDetail?id=${e.inner_id}`})},openMapApp(){if(!this.placeDetail||!this.placeDetail.geo)return void n({title:"暂无位置信息",icon:"none"});const e=this.placeDetail.geo[1],a=this.placeDetail.geo[0],t=this.placeDetail.name;p({latitude:e,longitude:a,name:t,address:t,scale:18})}},onShareAppMessage(e){return{title:"地点详情-"+this.placeDetail.name,path:"/pages/mapDetail/mapDetail?id="+this.id}},onShareTimeline(){return{title:"地点详情-"+this.placeDetail.name,query:"id="+this.id}},onLoad(e){const{id:a}=e;this.id=a,a?this.loadPlaceDetail(a):n({title:"缺少地点ID",icon:"none"})}},[["render",function(i,o,n,d,r,p){const w=y,M=c,x=k,I=s,F=v,L=C(u("i-navigation"),b);return e(),a(M,{class:"mapDetailContainer"},{default:t((()=>[r.placeDetail&&r.placeDetail.name?(e(),a(M,{key:1},{default:t((()=>[l(M,{class:"placeHeader"},{default:t((()=>[l(M,{class:"placeInfo"},{default:t((()=>[l(w,{class:"placeTitle"},{default:t((()=>[m(g(r.placeDetail.name),1)])),_:1}),r.placeDetail.note?(e(),a(w,{key:0,class:"placeNote"},{default:t((()=>[m(g(r.placeDetail.note),1)])),_:1})):f("",!0),l(w,{class:"placeLocation"},{default:t((()=>[m("坐标："+g(r.placeDetail.geo[1].toFixed(6))+", "+g(r.placeDetail.geo[0].toFixed(6)),1)])),_:1})])),_:1}),r.placeDetail.geo?(e(),a(M,{key:0,class:"miniMapContainer"},{default:t((()=>[l(x,{class:"miniMap",longitude:r.placeDetail.geo[0],latitude:r.placeDetail.geo[1],scale:16,markers:r.miniMapMarkers,"show-compass":!1,"show-location":!1,"enable-3d":!1,rotate:!1},null,8,["longitude","latitude","markers"])])),_:1})):f("",!0)])),_:1}),r.placeDetail.real_image_url?(e(),a(M,{key:0,class:"placeImageContainer"},{default:t((()=>[l(I,{src:r.placeDetail.real_image_url,class:"placeImage",mode:"widthFix"},null,8,["src"])])),_:1})):f("",!0),l(M,{class:"placeDetails"},{default:t((()=>[r.placeDetail.sources&&r.placeDetail.sources.length>0?(e(),a(M,{key:0,class:"detailSection"},{default:t((()=>[l(w,{class:"sectionTitle"},{default:t((()=>[m("相关来源")])),_:1}),(e(!0),h(D,null,_(r.placeDetail.sources,((i,s)=>(e(),a(M,{class:"sourceItem",key:s},{default:t((()=>[l(M,{class:"sourceHeader"},{default:t((()=>[l(w,{class:"sourceName"},{default:t((()=>[m(g(i.name),1)])),_:2},1024),l(w,{class:"sourceType"},{default:t((()=>[m(g(i.type),1)])),_:2},1024)])),_:2},1024),i.image_url?(e(),a(M,{key:0,class:"sourceImageWrapper"},{default:t((()=>[l(I,{src:i.image_url,class:"sourceImage",mode:"widthFix"},null,8,["src"])])),_:2},1024)):f("",!0),i.time?(e(),a(w,{key:1,class:"sourceTime"},{default:t((()=>[m("位于"+g(i.type)+"第"+g(Math.floor(i.time/60))+"分"+g(i.time%60)+"秒",1)])),_:2},1024)):f("",!0),l(M,{class:"sourceBtnRow"},{default:t((()=>[l(F,{class:"detailBtn",onClick:e=>p.handleSourceDetail(i)},{default:t((()=>["video"===i.type?(e(),h("img",{key:0,src:"/R-Mobile_Pages/assets/video-CeL1gV7H.png",class:"btnIcon"})):"pic"===i.type||"image"===i.type?(e(),h("img",{key:1,src:"/R-Mobile_Pages/assets/pic-Kzn48ORz.png",class:"btnIcon"})):f("",!0),l(w,null,{default:t((()=>[m("查看详情")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):f("",!0),r.placeDetail.note?(e(),a(M,{key:1,class:"detailSection"},{default:t((()=>[l(w,{class:"sectionTitle"},{default:t((()=>[m("备注")])),_:1}),l(w,{class:"detailNote"},{default:t((()=>[m(g(r.placeDetail.note),1)])),_:1})])),_:1})):f("",!0)])),_:1}),l(M,{class:"actionButtons"},{default:t((()=>[l(M,{class:"actionButton",onClick:p.openMapApp},{default:t((()=>[l(L,{theme:"outline",size:"24",fill:"#95C9EF"}),l(w,{class:"actionText"},{default:t((()=>[m("导航到这里")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})):(e(),a(M,{key:0,class:"loading"},{default:t((()=>[l(w,null,{default:t((()=>[m("加载中...")])),_:1})])),_:1}))])),_:1})}],["__scopeId","data-v-fdaee34c"]]);export{F as default};
